/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/markdown-it-implicit-figures@0.12.0/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var e=function(e,n){n=n||{},e.core.ruler.before("linkify","implicit_figures",(function(t){for(var i=1,r=1,l=t.tokens.length;r<l-1;++r){var a=t.tokens[r];if("inline"===a.type&&(a.children&&(1===a.children.length||3===a.children.length)&&(1!==a.children.length||"image"===a.children[0].type)&&(3!==a.children.length||"link_open"===a.children[0].type&&"image"===a.children[1].type&&"link_close"===a.children[2].type)&&!(0!==r&&"paragraph_open"!==t.tokens[r-1].type||r!==l-1&&"paragraph_close"!==t.tokens[r+1].type))){var c,h=t.tokens[r-1];if(h.type="figure_open",h.tag="figure",t.tokens[r+1].type="figure_close",t.tokens[r+1].tag="figure",1==n.dataType&&t.tokens[r-1].attrPush(["data-type","image"]),1==n.link&&1===a.children.length&&(c=a.children[0],a.children.unshift(new t.Token("link_open","a",1)),a.children[0].attrPush(["href",c.attrGet("src")]),a.children.push(new t.Token("link_close","a",-1))),c=1===a.children.length?a.children[0]:a.children[1],n.figcaption){var o=new String(n.figcaption).toLowerCase().trim();if("title"==o){var p,s=c.attrs.find((function([e]){return"title"===e}));if(Array.isArray(s)&&(p=s[1]),p){var d=e.parseInline(p),g={children:[]};Array.isArray(d)&&d.length&&(g=d[0]),a.children.push(new t.Token("figcaption_open","figcaption",1)),a.children.push(...g.children),a.children.push(new t.Token("figcaption_close","figcaption",-1)),c.attrs&&(c.attrs=c.attrs.filter((function([e]){return"title"!==e})))}}else 1!=n.figcaption&&"alt"!=o||c.children&&c.children.length&&(a.children.push(new t.Token("figcaption_open","figcaption",1)),a.children.splice(a.children.length,0,...c.children),a.children.push(new t.Token("figcaption_close","figcaption",-1)),n.keepAlt||(c.children.length=0))}if(n.copyAttrs&&c.attrs){var f=!0===n.copyAttrs?"":n.copyAttrs;h.attrs=c.attrs.filter((function([e]){return e.match(f)}))}1==n.tabindex&&(t.tokens[r-1].attrPush(["tabindex",i]),i++),1==n.lazyLoading&&c.attrPush(["loading","lazy"])}}}))};export{e as default};
//# sourceMappingURL=/sm/e63a7c6257235393b2f0586097025a1f119e56a3ae61a56091f02b53828650d7.map